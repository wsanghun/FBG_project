<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/mainlayout}">

<th:block layout:fragment="content" th:with="pageType='home'">
    <style>
        body {
            /*bgimage.png 파일 경로: /image/bgimage.png */
            <!--background-image: url("/image/bgimage.jpg");-->
            background-size: cover;          /* 화면을 꽉 채우도록 설정 */
            background-position: center;     /* 이미지를 중앙에 배치 */
            background-repeat: no-repeat;
            background-attachment: fixed;
            min-height: 100vh;
            margin: 0;
            font-family: sans-serif;
            display: flex;
            flex-direction: column;
        }
    </style>
    <div class="container">
        <h2>회원 목록</h2>
        <table class="table table-striped table-hover mt-4">
            <thead class="table-dark">
            <tr>
                <th>프로필 이미지</th>
                <th>아이디</th>
                <th>이름</th>
                <th>이메일</th>
                <th>성별</th>
                <th>가입일자</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="member : ${list}">
                <td>
                    <!--<img th:if="${member.profileImage != null}"
                         th:src="@{/images/{imageName}(imageName=${member.profileImage})}"
                         alt="프로필 이미지"
                         style="width: 50px; height: 50px; object-fit: cover;">-->
                    <!--<span th:unless="${member.profileImage != null}">N/A</span>-->
                    <span>N/A</span>
                </td>
                <td><a th:href="@{/user/view(idx=${member.idx})}" th:text="${member.userid}"></a></td>
                <td th:text="${member.name}"></td>
                <td th:text="${member.email}"></td>
                <td th:text="${member.gender}"></td>
                <td th:text="${member.regdate}"></td>

            </tr>
            </tbody>
        </table>

        <nav aria-label="Page navigation example">
            <ul class="pagination justify-content-center"
                th:with="
            currentPage=${list.number + 1},
            totalPages=${list != null ? list.totalPages : 0},
            pageGroupSize=5,

            startPage=${(currentPage - 1) / pageGroupSize * pageGroupSize + 1},

            endPage=${totalPages > 0 ?
                      ((startPage + pageGroupSize - 1 < totalPages) ? startPage + pageGroupSize - 1 : totalPages)
                      : 1}"
            >

                <li class="page-item" th:classappend="${list.first ? 'disabled' : ''}">
                    <a class="page-link" th:href="@{/user/memberlist(page=${list.number - 1}, size=${list.size}, key=${key}, word=${word})}" tabindex="-1">이전</a>
                </li>

                <li class="page-item" th:each="num : ${#numbers.sequence(startPage, endPage)}"
                    th:classappend="${num == currentPage ? 'active' : ''}"
                    th:if="${totalPages > 0}">
                    <a class="page-link" th:href="@{/user/memberlist(page=${num - 1}, size=${list.size}, key=${key}, word=${word})}" th:text="${num}">1</a>
                </li>

                <li class="page-item" th:classappend="${list.last ? 'disabled' : ''}">
                    <a class="page-link" th:href="@{/user/memberlist(page=${list.number + 1}, size=${list.size}, key=${key}, word=${word})}">다음</a>
                </li>
            </ul>
        </nav>

        <div class="mt-3 text-center">
            <a href=""><button class="btn btn-primary me-2">수정</button></a>
            <button class="btn btn-danger">삭제</button>
        </div>

        <div class="search-form-container">
            <form name="search_form" method="get" action="/user/memberlist" class="search-form-custom">
                <select name="key" class="search-select">
                    <option value="name" th:selected="${key == 'name'}">이름</option>
                    <option value="id" th:selected="${key == 'id'}">아이디</option>
                </select>
                <div class="search-box">
                    <input type="text" name="word" th:value="${word}" class="search-input">
                    <button type="submit" class="btn-secondary">검색</button>
                </div>
            </form>
        </div>
            </form>
        </div>
    </div>
    </th:block>
</html>